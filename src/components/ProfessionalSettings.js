import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useState, useEffect } from 'react';
import { getProfessionalBrand, updateProfessionalBrand } from '../services/mockBackend';
import { analyzeProfessionalProfile } from '../services/geminiService';
export const ProfessionalSettings = () => {
    const [brand, setBrand] = useState(null);
    const [notification, setNotification] = useState(null);
    // Calibration State
    const [isCalibrating, setIsCalibrating] = useState(false);
    const [isAnalyzing, setIsAnalyzing] = useState(false);
    const [answers, setAnswers] = useState({
        philosophy: '',
        reaction: '',
        communication: '',
        influence: ''
    });
    useEffect(() => {
        setBrand(getProfessionalBrand());
    }, []);
    const handleSave = () => {
        if (brand) {
            updateProfessionalBrand(brand);
            setNotification("Identidade visual atualizada com sucesso!");
            setTimeout(() => setNotification(null), 3000);
        }
    };
    const handleAnalyzeProfile = async () => {
        if (!answers.philosophy || !answers.reaction)
            return;
        setIsAnalyzing(true);
        try {
            const result = await analyzeProfessionalProfile(answers);
            if (brand) {
                setBrand({
                    ...brand,
                    personality: {
                        archetype: result.archetype,
                        customInstructions: result.customInstructions
                    }
                });
            }
            setIsCalibrating(false);
            setNotification("Perfil traÃ§ado com sucesso! A IA agora conhece sua voz.");
        }
        catch (error) {
            console.error(error);
            setNotification("Erro ao analisar perfil.");
        }
        finally {
            setIsAnalyzing(false);
        }
    };
    if (!brand)
        return _jsx("div", { children: "Carregando configura\u00E7\u00F5es..." });
    return (_jsxs("div", { className: "bg-white rounded-xl shadow-sm p-6 h-full overflow-y-auto", children: [_jsx("h2", { className: "font-serif font-bold text-2xl text-stone-800 mb-6", children: "Configura\u00E7\u00E3o do Consult\u00F3rio" }), _jsxs("div", { className: "space-y-6 max-w-2xl", children: [_jsxs("div", { className: "space-y-4 border-b border-stone-100 pb-6", children: [_jsx("h3", { className: "font-bold text-stone-600 uppercase text-xs tracking-wider", children: "Perfil Profissional" }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm font-medium text-stone-700 mb-1", children: "Nome de Exibi\u00E7\u00E3o" }), _jsx("input", { type: "text", value: brand.professionalName, onChange: e => setBrand({ ...brand, professionalName: e.target.value }), className: "w-full p-2 border border-stone-300 rounded-md" })] }), _jsxs("div", { className: "grid grid-cols-2 gap-4", children: [_jsxs("div", { children: [_jsx("label", { className: "block text-sm font-medium text-stone-700 mb-1", children: "URL da Foto de Perfil" }), _jsx("input", { type: "text", value: brand.photoUrl, onChange: e => setBrand({ ...brand, photoUrl: e.target.value }), className: "w-full p-2 border border-stone-300 rounded-md text-xs" }), _jsx("div", { className: "mt-2 w-16 h-16 rounded-full overflow-hidden border border-stone-200", children: _jsx("img", { src: brand.photoUrl, alt: "Preview", className: "w-full h-full object-cover" }) })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm font-medium text-stone-700 mb-1", children: "URL do Logo" }), _jsx("input", { type: "text", value: brand.logoUrl, onChange: e => setBrand({ ...brand, logoUrl: e.target.value }), className: "w-full p-2 border border-stone-300 rounded-md text-xs" }), _jsx("div", { className: "mt-2 w-16 h-16 flex items-center justify-center border border-stone-200 rounded-lg p-2", children: _jsx("img", { src: brand.logoUrl, alt: "Logo Preview", className: "max-w-full max-h-full" }) })] })] })] }), _jsxs("div", { className: "space-y-4 border-b border-stone-100 pb-6", children: [_jsxs("div", { className: "flex justify-between items-center", children: [_jsx("h3", { className: "font-bold text-stone-600 uppercase text-xs tracking-wider", children: "Personalidade da IA (Sua Voz)" }), _jsx("button", { onClick: () => setIsCalibrating(!isCalibrating), className: "text-xs text-amber-600 font-bold hover:underline", children: isCalibrating ? 'Cancelar Calibragem' : 'ðŸ”„ Recalibrar Perfil' })] }), _jsx("p", { className: "text-xs text-stone-500", children: "A IA utiliza essas configura\u00E7\u00F5es para imitar seu estilo de atendimento." }), isCalibrating ? (_jsxs("div", { className: "bg-stone-50 p-6 rounded-xl border border-stone-200 space-y-4 animate-enter", children: [_jsx("h4", { className: "font-serif font-bold text-lg text-stone-800", children: "Mapeamento de Personalidade" }), _jsx("p", { className: "text-sm text-stone-600", children: "Responda com sinceridade para que a IA capture sua ess\u00EAncia." }), _jsxs("div", { children: [_jsx("label", { className: "block text-xs font-bold text-stone-500 mb-1", children: "1. Qual \u00E9 a sua filosofia central de atendimento?" }), _jsx("textarea", { value: answers.philosophy, onChange: e => setAnswers({ ...answers, philosophy: e.target.value }), placeholder: "Ex: Acredito que o acolhimento vem antes da t\u00E9cnica...", className: "w-full p-3 border border-stone-300 rounded-md text-sm h-20" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-xs font-bold text-stone-500 mb-1", children: "2. Como voc\u00EA reage quando um paciente falha?" }), _jsx("textarea", { value: answers.reaction, onChange: e => setAnswers({ ...answers, reaction: e.target.value }), placeholder: "Ex: Sou firme, mostro que a responsabilidade \u00E9 dele...", className: "w-full p-3 border border-stone-300 rounded-md text-sm h-20" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-xs font-bold text-stone-500 mb-1", children: "3. Defina seu estilo de comunica\u00E7\u00E3o" }), _jsx("textarea", { value: answers.communication, onChange: e => setAnswers({ ...answers, communication: e.target.value }), placeholder: "Ex: Uso muitas met\u00E1foras, falo de forma po\u00E9tica...", className: "w-full p-3 border border-stone-300 rounded-md text-sm h-20" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-xs font-bold text-stone-500 mb-1", children: "4. Quem s\u00E3o suas maiores influ\u00EAncias?" }), _jsx("input", { type: "text", value: answers.influence, onChange: e => setAnswers({ ...answers, influence: e.target.value }), placeholder: "Ex: Jung, S\u00EAneca, Bren\u00E9 Brown...", className: "w-full p-3 border border-stone-300 rounded-md text-sm" })] }), _jsx("button", { onClick: handleAnalyzeProfile, disabled: isAnalyzing || !answers.philosophy, className: "w-full bg-stone-900 text-white py-3 rounded-lg font-bold hover:bg-stone-800 disabled:opacity-50 transition-all flex justify-center items-center gap-2", children: isAnalyzing ? (_jsxs(_Fragment, { children: [_jsx("div", { className: "w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" }), "Analisando Perfil..."] })) : ('Gerar Minha Identidade Digital') })] })) : (_jsxs("div", { className: "bg-white p-4 rounded-lg border border-stone-200 shadow-sm", children: [_jsxs("div", { className: "flex items-center gap-2 mb-2", children: [_jsx("span", { className: "text-xl", children: brand.personality?.archetype === 'thomist' ? 'âœï¸' :
                                                    brand.personality?.archetype === 'tough-love' ? 'ðŸ”¥' :
                                                        brand.personality?.archetype === 'analytical' ? 'ðŸ”¬' : 'ðŸŒ±' }), _jsxs("span", { className: "font-bold capitalize text-stone-800", children: ["Arqu\u00E9tipo: ", brand.personality?.archetype || 'NÃ£o definido'] })] }), _jsxs("div", { className: "text-sm text-stone-600 italic bg-stone-50 p-3 rounded border border-stone-100", children: ["\"", brand.personality?.customInstructions || 'Nenhuma instruÃ§Ã£o definida.', "\""] })] }))] }), _jsxs("div", { className: "space-y-4", children: [_jsx("h3", { className: "font-bold text-stone-600 uppercase text-xs tracking-wider", children: "Identidade Visual (White Label)" }), _jsx("p", { className: "text-xs text-stone-500", children: "Essas cores ser\u00E3o aplicadas no aplicativo dos seus pacientes." }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-6", children: [_jsxs("div", { children: [_jsx("label", { className: "block text-sm font-medium text-stone-700 mb-1", children: "Cor Prim\u00E1ria" }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx("input", { type: "color", value: brand.primaryColor, onChange: e => setBrand({ ...brand, primaryColor: e.target.value }), className: "h-10 w-10 rounded cursor-pointer border-0" }), _jsx("span", { className: "text-xs font-mono text-stone-500", children: brand.primaryColor })] }), _jsx("p", { className: "text-[10px] text-stone-400 mt-1", children: "Cabe\u00E7alhos, Bot\u00F5es Principais" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm font-medium text-stone-700 mb-1", children: "Cor de Destaque" }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx("input", { type: "color", value: brand.accentColor, onChange: e => setBrand({ ...brand, accentColor: e.target.value }), className: "h-10 w-10 rounded cursor-pointer border-0" }), _jsx("span", { className: "text-xs font-mono text-stone-500", children: brand.accentColor })] }), _jsx("p", { className: "text-[10px] text-stone-400 mt-1", children: "Detalhes, Links, \u00CDcones" })] }), _jsxs("div", { children: [_jsx("label", { className: "block text-sm font-medium text-stone-700 mb-1", children: "Cor de Fundo" }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx("input", { type: "color", value: brand.backgroundColor, onChange: e => setBrand({ ...brand, backgroundColor: e.target.value }), className: "h-10 w-10 rounded cursor-pointer border-0" }), _jsx("span", { className: "text-xs font-mono text-stone-500", children: brand.backgroundColor })] }), _jsx("p", { className: "text-[10px] text-stone-400 mt-1", children: "Fundo da tela do App" })] })] }), _jsxs("div", { className: "mt-6 p-4 rounded-xl border border-stone-200", style: { backgroundColor: brand.backgroundColor }, children: [_jsx("h4", { className: "text-xs font-bold mb-2", style: { color: brand.primaryColor }, children: "Preview do App do Paciente" }), _jsxs("div", { className: "bg-white p-4 rounded-lg shadow-sm border border-stone-100", children: [_jsxs("div", { className: "flex items-center gap-2 mb-4", children: [_jsx("div", { className: "w-8 h-8 rounded-full flex items-center justify-center text-white font-bold", style: { backgroundColor: brand.primaryColor }, children: "\u03A6" }), _jsx("span", { className: "font-bold", style: { color: brand.primaryColor }, children: brand.professionalName })] }), _jsx("button", { className: "w-full py-2 rounded-lg text-white font-medium text-sm", style: { backgroundColor: brand.primaryColor }, children: "Bot\u00E3o Principal" }), _jsx("p", { className: "mt-2 text-sm", style: { color: brand.accentColor }, children: "Texto de destaque ou link" })] })] })] }), _jsxs("div", { className: "pt-4", children: [_jsx("button", { onClick: handleSave, className: "bg-stone-900 text-white px-8 py-3 rounded-lg font-bold hover:bg-stone-800 transition-colors w-full md:w-auto", children: "Salvar Altera\u00E7\u00F5es" }), notification && (_jsx("p", { className: "mt-2 text-green-600 text-sm text-center md:text-left animate-pulse", children: notification }))] })] })] }));
};
